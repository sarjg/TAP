<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://java.sun.com/jsf/html"> 

<h:head>
    <title>Buscar Producto</title>
</h:head>
<h:body>
    <h1>Bienvenido!</h1>
    <h2>Estas en el supermercado Eroski San Mames #{buscarProductoBean.nombreSupermercado}</h2>        
    <p>Introduzca el producto que desea buscar</p>
    <h:form>
        <h:panelGrid columns="2">
            <h:outputLabel value="Producto:" />
            <p:inputText id="producto" value="#{buscarProductoBean.nombreProducto}" required="true" requiredMessage="Debe introducir un producto" />
            <p:commandButton value="Buscar" action="#{buscarProductoBean.buscarProducto}" ajax="false" />
       </h:panelGrid>
    </h:form>    
    #{buscarProductoBean.warn}
    #{buscarProductoBean.pasillo}
    #{buscarProductoBean.estanteria}
    <h:panelGroup rendered="#{not empty buscarProductoBean.producto}">
        <h:dataTable value="#{buscarProductoBean.producto}" var="producto">
            <h:column>
                <f:facet name="header">Nombre</f:facet>
                #{producto.nombre}
            </h:column>
            <h:column>
                <f:facet name="header">Precio</f:facet>
                #{producto.precio}
            </h:column>
        </h:dataTable>
        <div>
            <img id='theImg' src='https://folio-uploads-pro.s3.eu-west-1.amazonaws.com/wp-content/uploads/sites/871/2021/02/26170509/Artboard-1.jpg'></img>
            <canvas id='myCanvas' width='536px' height='536px'></canvas>
            <script>
                function Draw() {
                    var img = document.getElementById("theImg");
                    var cnvs = document.getElementById("myCanvas");
                    cnvs.style.position = "absolute";
                    cnvs.style.left = img.offsetLeft + "px";
                    cnvs.style.top = img.offsetTop + "px";

                    var ctx = cnvs.getContext("2d");
                    ctx.beginPath();            
                    ctx.arc(#{buscarProductoBean.pasillo}, #{buscarProductoBean.estanteria}, 10, 0, 2 * Math.PI); // x, y y radio
                    ctx.lineWidth = 2;
                    ctx.strokeStyle = '#5c92ff';
                    ctx.stroke();
                    ctx.fillStyle = 'rgba(0, 150, 255, 0.5)';
                    ctx.fill();
                }
                Draw();
            </script>
        </div>
    </h:panelGroup>
</h:body>
</html>

